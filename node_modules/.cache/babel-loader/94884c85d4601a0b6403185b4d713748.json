{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.VerusPayInvoice = exports.VERUSPAY_VERSION_MASK = exports.VERUSPAY_VERSION_SIGNED = exports.VERUSPAY_VERSION_LASTVALID = exports.VERUSPAY_VERSION_FIRSTVALID = exports.VERUSPAY_VERSION_CURRENT = void 0;\nconst __1 = require(\"../../\");\nconst keys_1 = require(\"../../keys\");\nconst Hash160_1 = require(\"./../Hash160\");\nconst bufferutils_1 = require(\"../../../utils/bufferutils\");\nconst vdxf_1 = require(\"../../../constants/vdxf\");\nconst address_1 = require(\"../../../utils/address\");\nconst createHash = require(\"create-hash\");\nconst base64url_1 = require(\"base64url\");\nconst VerusPayInvoiceDetails_1 = require(\"./VerusPayInvoiceDetails\");\nconst bn_js_1 = require(\"bn.js\");\nexports.VERUSPAY_VERSION_CURRENT = new bn_js_1.BN(3, 10);\nexports.VERUSPAY_VERSION_FIRSTVALID = new bn_js_1.BN(3, 10);\nexports.VERUSPAY_VERSION_LASTVALID = new bn_js_1.BN(3, 10);\nexports.VERUSPAY_VERSION_SIGNED = new bn_js_1.BN('80000000', 16);\nexports.VERUSPAY_VERSION_MASK = exports.VERUSPAY_VERSION_SIGNED;\nclass VerusPayInvoice extends __1.VDXFObject {\n  constructor(request = {\n    details: new VerusPayInvoiceDetails_1.VerusPayInvoiceDetails()\n  }) {\n    super(__1.VERUSPAY_INVOICE_VDXF_KEY.vdxfid);\n    this.system_id = request.system_id;\n    this.signing_id = request.signing_id;\n    this.signature = request.signature ? new __1.VerusIDSignature(request.signature, keys_1.IDENTITY_AUTH_SIG_VDXF_KEY, false) : undefined;\n    this.details = new VerusPayInvoiceDetails_1.VerusPayInvoiceDetails(request.details);\n    if (request.version) this.version = request.version;else this.version = exports.VERUSPAY_VERSION_CURRENT;\n  }\n  getVersionNoFlags() {\n    return this.version.and(exports.VERUSPAY_VERSION_MASK.notn(exports.VERUSPAY_VERSION_MASK.bitLength()));\n  }\n  isValidVersion() {\n    return this.getVersionNoFlags().gte(exports.VERUSPAY_VERSION_FIRSTVALID) && this.getVersionNoFlags().lte(exports.VERUSPAY_VERSION_LASTVALID);\n  }\n  isSigned() {\n    return !!this.version.and(exports.VERUSPAY_VERSION_SIGNED).toNumber();\n  }\n  setSigned() {\n    this.version = this.version.xor(exports.VERUSPAY_VERSION_SIGNED);\n  }\n  getDetailsHash(signedBlockheight, signatureVersion = 2) {\n    if (this.isSigned()) {\n      var heightBufferWriter = new bufferutils_1.default.BufferWriter(Buffer.allocUnsafe(4));\n      heightBufferWriter.writeUInt32(signedBlockheight);\n      if (signatureVersion === 1) {\n        return createHash(\"sha256\").update(vdxf_1.VERUS_DATA_SIGNATURE_PREFIX).update((0, address_1.fromBase58Check)(this.system_id).hash).update(heightBufferWriter.buffer).update((0, address_1.fromBase58Check)(this.signing_id).hash).update(this.details.toSha256()).digest();\n      } else {\n        return createHash(\"sha256\").update((0, address_1.fromBase58Check)(this.system_id).hash).update(heightBufferWriter.buffer).update((0, address_1.fromBase58Check)(this.signing_id).hash).update(vdxf_1.VERUS_DATA_SIGNATURE_PREFIX).update(this.details.toSha256()).digest();\n      }\n    } else return this.details.toSha256();\n  }\n  _dataByteLength(signer = this.signing_id) {\n    if (this.isSigned()) {\n      let length = 0;\n      const _signature = this.signature ? this.signature : new __1.VerusIDSignature({\n        signature: \"\"\n      }, keys_1.IDENTITY_AUTH_SIG_VDXF_KEY, false);\n      const _system_id = Hash160_1.Hash160.fromAddress(this.system_id);\n      length += _system_id.byteLength();\n      const _signing_id = Hash160_1.Hash160.fromAddress(signer);\n      length += _signing_id.byteLength();\n      length += _signature.byteLength();\n      length += this.details.getByteLength();\n      return length;\n    } else return this.details.getByteLength();\n  }\n  _toDataBuffer(signer = this.signing_id) {\n    const writer = new bufferutils_1.default.BufferWriter(Buffer.alloc(this.dataByteLength()));\n    if (this.isSigned()) {\n      const _signing_id = Hash160_1.Hash160.fromAddress(signer);\n      const _signature = this.signature ? this.signature : new __1.VerusIDSignature({\n        signature: \"\"\n      }, keys_1.IDENTITY_AUTH_SIG_VDXF_KEY, false);\n      const _system_id = Hash160_1.Hash160.fromAddress(this.system_id);\n      writer.writeSlice(_system_id.toBuffer());\n      writer.writeSlice(_signing_id.toBuffer());\n      writer.writeSlice(_signature.toBuffer());\n    }\n    writer.writeSlice(this.details.toBuffer());\n    return writer.buffer;\n  }\n  dataByteLength() {\n    return this._dataByteLength();\n  }\n  toDataBuffer() {\n    return this._toDataBuffer();\n  }\n  _fromDataBuffer(buffer, offset) {\n    const reader = new bufferutils_1.default.BufferReader(buffer, offset);\n    const reqLength = reader.readCompactSize();\n    if (reqLength == 0) {\n      throw new Error(\"Cannot create request from empty buffer\");\n    } else {\n      if (this.isSigned()) {\n        this.system_id = (0, address_1.toBase58Check)(reader.readSlice(vdxf_1.HASH160_BYTE_LENGTH), vdxf_1.I_ADDR_VERSION);\n        this.signing_id = (0, address_1.toBase58Check)(reader.readSlice(vdxf_1.HASH160_BYTE_LENGTH), vdxf_1.I_ADDR_VERSION);\n        const _sig = new __1.VerusIDSignature(undefined, keys_1.IDENTITY_AUTH_SIG_VDXF_KEY, false);\n        reader.offset = _sig.fromBuffer(reader.buffer, reader.offset, keys_1.IDENTITY_AUTH_SIG_VDXF_KEY.vdxfid);\n        this.signature = _sig;\n      }\n      const _details = new VerusPayInvoiceDetails_1.VerusPayInvoiceDetails();\n      reader.offset = _details.fromBuffer(reader.buffer, reader.offset);\n      this.details = _details;\n    }\n    return reader.offset;\n  }\n  fromDataBuffer(buffer, offset) {\n    return this._fromDataBuffer(buffer, offset);\n  }\n  toWalletDeeplinkUri() {\n    return `${__1.WALLET_VDXF_KEY.vdxfid.toLowerCase()}://x-callback-url/${__1.VERUSPAY_INVOICE_VDXF_KEY.vdxfid}/${this.toString(false)}`;\n  }\n  static fromWalletDeeplinkUri(uri) {\n    const split = uri.split(`${__1.VERUSPAY_INVOICE_VDXF_KEY.vdxfid}/`);\n    const inv = new VerusPayInvoice();\n    inv.fromBuffer(base64url_1.default.toBuffer(split[1]), 0, __1.VERUSPAY_INVOICE_VDXF_KEY.vdxfid);\n    return inv;\n  }\n  toQrString() {\n    return this.toString(true);\n  }\n  static fromQrString(qrstring) {\n    const inv = new VerusPayInvoice();\n    inv.fromBuffer(base64url_1.default.toBuffer(qrstring), 0);\n    return inv;\n  }\n  static fromJson(data) {\n    return new VerusPayInvoice({\n      details: VerusPayInvoiceDetails_1.VerusPayInvoiceDetails.fromJson(data.details),\n      signature: data.signature != null ? __1.VerusIDSignature.fromJson(data.signature) : undefined,\n      signing_id: data.signing_id,\n      system_id: data.system_id,\n      version: new bn_js_1.BN(data.version)\n    });\n  }\n  toJson() {\n    return {\n      vdxfkey: this.vdxfkey,\n      system_id: this.system_id,\n      signing_id: this.signing_id,\n      signature: this.isSigned() ? this.signature.toJson() : this.signature,\n      details: this.details.toJson(),\n      version: this.version.toString()\n    };\n  }\n}\nexports.VerusPayInvoice = VerusPayInvoice;","map":{"version":3,"names":["Object","defineProperty","exports","value","VerusPayInvoice","VERUSPAY_VERSION_MASK","VERUSPAY_VERSION_SIGNED","VERUSPAY_VERSION_LASTVALID","VERUSPAY_VERSION_FIRSTVALID","VERUSPAY_VERSION_CURRENT","__1","require","keys_1","Hash160_1","bufferutils_1","vdxf_1","address_1","createHash","base64url_1","VerusPayInvoiceDetails_1","bn_js_1","BN","VDXFObject","constructor","request","details","VerusPayInvoiceDetails","VERUSPAY_INVOICE_VDXF_KEY","vdxfid","system_id","signing_id","signature","VerusIDSignature","IDENTITY_AUTH_SIG_VDXF_KEY","undefined","version","getVersionNoFlags","and","notn","bitLength","isValidVersion","gte","lte","isSigned","toNumber","setSigned","xor","getDetailsHash","signedBlockheight","signatureVersion","heightBufferWriter","default","BufferWriter","Buffer","allocUnsafe","writeUInt32","update","VERUS_DATA_SIGNATURE_PREFIX","fromBase58Check","hash","buffer","toSha256","digest","_dataByteLength","signer","length","_signature","_system_id","Hash160","fromAddress","byteLength","_signing_id","getByteLength","_toDataBuffer","writer","alloc","dataByteLength","writeSlice","toBuffer","toDataBuffer","_fromDataBuffer","offset","reader","BufferReader","reqLength","readCompactSize","Error","toBase58Check","readSlice","HASH160_BYTE_LENGTH","I_ADDR_VERSION","_sig","fromBuffer","_details","fromDataBuffer","toWalletDeeplinkUri","WALLET_VDXF_KEY","toLowerCase","toString","fromWalletDeeplinkUri","uri","split","inv","toQrString","fromQrString","qrstring","fromJson","data","toJson","vdxfkey"],"sources":["/Users/oddfl3x/Code/bridge2/NATI<>bridge_API_SWAP/node_modules/verus-typescript-primitives/dist/vdxf/classes/payment/VerusPayInvoice.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.VerusPayInvoice = exports.VERUSPAY_VERSION_MASK = exports.VERUSPAY_VERSION_SIGNED = exports.VERUSPAY_VERSION_LASTVALID = exports.VERUSPAY_VERSION_FIRSTVALID = exports.VERUSPAY_VERSION_CURRENT = void 0;\nconst __1 = require(\"../../\");\nconst keys_1 = require(\"../../keys\");\nconst Hash160_1 = require(\"./../Hash160\");\nconst bufferutils_1 = require(\"../../../utils/bufferutils\");\nconst vdxf_1 = require(\"../../../constants/vdxf\");\nconst address_1 = require(\"../../../utils/address\");\nconst createHash = require(\"create-hash\");\nconst base64url_1 = require(\"base64url\");\nconst VerusPayInvoiceDetails_1 = require(\"./VerusPayInvoiceDetails\");\nconst bn_js_1 = require(\"bn.js\");\nexports.VERUSPAY_VERSION_CURRENT = new bn_js_1.BN(3, 10);\nexports.VERUSPAY_VERSION_FIRSTVALID = new bn_js_1.BN(3, 10);\nexports.VERUSPAY_VERSION_LASTVALID = new bn_js_1.BN(3, 10);\nexports.VERUSPAY_VERSION_SIGNED = new bn_js_1.BN('80000000', 16);\nexports.VERUSPAY_VERSION_MASK = exports.VERUSPAY_VERSION_SIGNED;\nclass VerusPayInvoice extends __1.VDXFObject {\n    constructor(request = {\n        details: new VerusPayInvoiceDetails_1.VerusPayInvoiceDetails(),\n    }) {\n        super(__1.VERUSPAY_INVOICE_VDXF_KEY.vdxfid);\n        this.system_id = request.system_id;\n        this.signing_id = request.signing_id;\n        this.signature = request.signature\n            ? new __1.VerusIDSignature(request.signature, keys_1.IDENTITY_AUTH_SIG_VDXF_KEY, false)\n            : undefined;\n        this.details = new VerusPayInvoiceDetails_1.VerusPayInvoiceDetails(request.details);\n        if (request.version)\n            this.version = request.version;\n        else\n            this.version = exports.VERUSPAY_VERSION_CURRENT;\n    }\n    getVersionNoFlags() {\n        return this.version.and(exports.VERUSPAY_VERSION_MASK.notn(exports.VERUSPAY_VERSION_MASK.bitLength()));\n    }\n    isValidVersion() {\n        return this.getVersionNoFlags().gte(exports.VERUSPAY_VERSION_FIRSTVALID) && this.getVersionNoFlags().lte(exports.VERUSPAY_VERSION_LASTVALID);\n    }\n    isSigned() {\n        return !!(this.version.and(exports.VERUSPAY_VERSION_SIGNED).toNumber());\n    }\n    setSigned() {\n        this.version = this.version.xor(exports.VERUSPAY_VERSION_SIGNED);\n    }\n    getDetailsHash(signedBlockheight, signatureVersion = 2) {\n        if (this.isSigned()) {\n            var heightBufferWriter = new bufferutils_1.default.BufferWriter(Buffer.allocUnsafe(4));\n            heightBufferWriter.writeUInt32(signedBlockheight);\n            if (signatureVersion === 1) {\n                return createHash(\"sha256\")\n                    .update(vdxf_1.VERUS_DATA_SIGNATURE_PREFIX)\n                    .update((0, address_1.fromBase58Check)(this.system_id).hash)\n                    .update(heightBufferWriter.buffer)\n                    .update((0, address_1.fromBase58Check)(this.signing_id).hash)\n                    .update(this.details.toSha256())\n                    .digest();\n            }\n            else {\n                return createHash(\"sha256\")\n                    .update((0, address_1.fromBase58Check)(this.system_id).hash)\n                    .update(heightBufferWriter.buffer)\n                    .update((0, address_1.fromBase58Check)(this.signing_id).hash)\n                    .update(vdxf_1.VERUS_DATA_SIGNATURE_PREFIX)\n                    .update(this.details.toSha256())\n                    .digest();\n            }\n        }\n        else\n            return this.details.toSha256();\n    }\n    _dataByteLength(signer = this.signing_id) {\n        if (this.isSigned()) {\n            let length = 0;\n            const _signature = this.signature\n                ? this.signature\n                : new __1.VerusIDSignature({ signature: \"\" }, keys_1.IDENTITY_AUTH_SIG_VDXF_KEY, false);\n            const _system_id = Hash160_1.Hash160.fromAddress(this.system_id);\n            length += _system_id.byteLength();\n            const _signing_id = Hash160_1.Hash160.fromAddress(signer);\n            length += _signing_id.byteLength();\n            length += _signature.byteLength();\n            length += this.details.getByteLength();\n            return length;\n        }\n        else\n            return this.details.getByteLength();\n    }\n    _toDataBuffer(signer = this.signing_id) {\n        const writer = new bufferutils_1.default.BufferWriter(Buffer.alloc(this.dataByteLength()));\n        if (this.isSigned()) {\n            const _signing_id = Hash160_1.Hash160.fromAddress(signer);\n            const _signature = this.signature\n                ? this.signature\n                : new __1.VerusIDSignature({ signature: \"\" }, keys_1.IDENTITY_AUTH_SIG_VDXF_KEY, false);\n            const _system_id = Hash160_1.Hash160.fromAddress(this.system_id);\n            writer.writeSlice(_system_id.toBuffer());\n            writer.writeSlice(_signing_id.toBuffer());\n            writer.writeSlice(_signature.toBuffer());\n        }\n        writer.writeSlice(this.details.toBuffer());\n        return writer.buffer;\n    }\n    dataByteLength() {\n        return this._dataByteLength();\n    }\n    toDataBuffer() {\n        return this._toDataBuffer();\n    }\n    _fromDataBuffer(buffer, offset) {\n        const reader = new bufferutils_1.default.BufferReader(buffer, offset);\n        const reqLength = reader.readCompactSize();\n        if (reqLength == 0) {\n            throw new Error(\"Cannot create request from empty buffer\");\n        }\n        else {\n            if (this.isSigned()) {\n                this.system_id = (0, address_1.toBase58Check)(reader.readSlice(vdxf_1.HASH160_BYTE_LENGTH), vdxf_1.I_ADDR_VERSION);\n                this.signing_id = (0, address_1.toBase58Check)(reader.readSlice(vdxf_1.HASH160_BYTE_LENGTH), vdxf_1.I_ADDR_VERSION);\n                const _sig = new __1.VerusIDSignature(undefined, keys_1.IDENTITY_AUTH_SIG_VDXF_KEY, false);\n                reader.offset = _sig.fromBuffer(reader.buffer, reader.offset, keys_1.IDENTITY_AUTH_SIG_VDXF_KEY.vdxfid);\n                this.signature = _sig;\n            }\n            const _details = new VerusPayInvoiceDetails_1.VerusPayInvoiceDetails();\n            reader.offset = _details.fromBuffer(reader.buffer, reader.offset);\n            this.details = _details;\n        }\n        return reader.offset;\n    }\n    fromDataBuffer(buffer, offset) {\n        return this._fromDataBuffer(buffer, offset);\n    }\n    toWalletDeeplinkUri() {\n        return `${__1.WALLET_VDXF_KEY.vdxfid.toLowerCase()}://x-callback-url/${__1.VERUSPAY_INVOICE_VDXF_KEY.vdxfid}/${this.toString(false)}`;\n    }\n    static fromWalletDeeplinkUri(uri) {\n        const split = uri.split(`${__1.VERUSPAY_INVOICE_VDXF_KEY.vdxfid}/`);\n        const inv = new VerusPayInvoice();\n        inv.fromBuffer(base64url_1.default.toBuffer(split[1]), 0, __1.VERUSPAY_INVOICE_VDXF_KEY.vdxfid);\n        return inv;\n    }\n    toQrString() {\n        return this.toString(true);\n    }\n    static fromQrString(qrstring) {\n        const inv = new VerusPayInvoice();\n        inv.fromBuffer(base64url_1.default.toBuffer(qrstring), 0);\n        return inv;\n    }\n    static fromJson(data) {\n        return new VerusPayInvoice({\n            details: VerusPayInvoiceDetails_1.VerusPayInvoiceDetails.fromJson(data.details),\n            signature: data.signature != null ? __1.VerusIDSignature.fromJson(data.signature) : undefined,\n            signing_id: data.signing_id,\n            system_id: data.system_id,\n            version: new bn_js_1.BN(data.version)\n        });\n    }\n    toJson() {\n        return {\n            vdxfkey: this.vdxfkey,\n            system_id: this.system_id,\n            signing_id: this.signing_id,\n            signature: this.isSigned() ? this.signature.toJson() : this.signature,\n            details: this.details.toJson(),\n            version: this.version.toString()\n        };\n    }\n}\nexports.VerusPayInvoice = VerusPayInvoice;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script"}